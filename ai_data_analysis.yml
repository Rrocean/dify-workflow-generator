version: 0.5.0
kind: app
app:
  name: AI æ™ºèƒ½é—®æ•°
  mode: workflow
  icon: ğŸ“Š
  icon_background: '#FFEAD5'
  description: å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸º SQL æŸ¥è¯¢å¹¶åˆ†ææ•°æ®ç»“æœ
  use_icon_as_answer_icon: false
workflow:
  graph:
    nodes:
    - id: start
      position:
        x: 100
        y: 300
      width: 244
      height: 54
      data:
        type: start
        title: Start
        desc: ''
        variables:
        - variable: query
          type: string
          label: æ•°æ®é—®é¢˜
          required: true
          max_length: 256
          default: ''
          options: []
        - variable: table_schema
          type: string
          label: è¡¨ç»“æ„
          required: false
          max_length: 256
          default: CREATE TABLE sales (date DATE, amount DECIMAL, region VARCHAR)
          options: []
    - id: d7579be0
      position:
        x: 400
        y: 100
      width: 244
      height: 54
      data:
        type: llm
        title: ç”ŸæˆSQL
        desc: ''
        model:
          provider: openai
          name: gpt-4
          mode: chat
          completion_params:
            temperature: 0.7
            max_tokens: 4096
        prompt_template:
        - role: user
          text: 'ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æå¸ˆã€‚æ ¹æ®ä»¥ä¸‹è¡¨ç»“æ„ï¼Œå°†ç”¨æˆ·é—®é¢˜è½¬æ¢ä¸º SQL æŸ¥è¯¢è¯­å¥ã€‚


            è¡¨ç»“æ„ï¼š

            {{#start.table_schema#}}


            ç”¨æˆ·é—®é¢˜ï¼š

            {{#start.query#}}


            è¯·åªè¾“å‡º SQL è¯­å¥ï¼Œä¸è¦åŒ…å«å…¶ä»–è§£é‡Šã€‚'
    - id: f3dc8e41
      position:
        x: 700
        y: 100
      width: 244
      height: 54
      data:
        type: code
        title: æ‰§è¡ŒæŸ¥è¯¢
        desc: ''
        code_language: python3
        code: "def main(args):\n    sql = args.get(\"sql\")\n    # è¿™é‡Œæ¨¡æ‹Ÿæ•°æ®åº“è¿”å›ç»“æœ\n \
          \   # å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é‡Œä¼šè¿æ¥æ•°æ®åº“æ‰§è¡Œ SQL\n    print(f\"Executing: {sql}\")\n    \n   \
          \ mock_data = [\n        {\"date\": \"2024-01-01\", \"amount\": 1000, \"\
          region\": \"North\"},\n        {\"date\": \"2024-01-02\", \"amount\": 1500,\
          \ \"region\": \"South\"}\n    ]\n    \n    return {\n        \"result\"\
          : mock_data,\n        \"status\": \"success\"\n    }\n"
        variables:
        - variable: sql
          value_selector:
          - ç”ŸæˆSQL
          - text
        outputs:
        - variable: result
          type: array-object
    - id: 70e52fd5
      position:
        x: 100
        y: 300
      width: 244
      height: 54
      data:
        type: llm
        title: åˆ†æç»“æœ
        desc: ''
        model:
          provider: openai
          name: gpt-4
          mode: chat
          completion_params:
            temperature: 0.7
            max_tokens: 4096
        prompt_template:
        - role: user
          text: 'æ ¹æ®æ‰§è¡Œçš„ SQL å’Œæ•°æ®ç»“æœï¼Œå›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚


            é—®é¢˜ï¼š{{#start.query#}}

            SQLï¼š{{#ç”ŸæˆSQL.text#}}

            æ•°æ®ç»“æœï¼š

            {{#æ‰§è¡ŒæŸ¥è¯¢.result#}}


            è¯·ç”¨é€šä¿—æ˜“æ‡‚çš„è¯­è¨€æ€»ç»“æ•°æ®æ´å¯Ÿã€‚'
    - id: 743de7ae
      position:
        x: 400
        y: 300
      width: 244
      height: 54
      data:
        type: end
        title: End
        desc: ''
        outputs:
        - variable: answer
          value_selector:
          - åˆ†æç»“æœ
          - text
        - variable: sql
          value_selector:
          - ç”ŸæˆSQL
          - text
    edges:
    - id: edge_0
      source: start
      target: d7579be0
      sourceHandle: source
      targetHandle: target
    - id: edge_1
      source: d7579be0
      target: f3dc8e41
      sourceHandle: source
      targetHandle: target
    - id: edge_2
      source: f3dc8e41
      target: 70e52fd5
      sourceHandle: source
      targetHandle: target
    - id: edge_3
      source: 70e52fd5
      target: 743de7ae
      sourceHandle: source
      targetHandle: target
  features: {}
  environment_variables: []
  conversation_variables: []
